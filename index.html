<!DOCTYPE html>
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-344TEL23VN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-344TEL23VN');
</script>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PTQM8PHK');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="squishh - Professional image compression and conversion tool. Batch process multiple images, support for HEIC, JPEG, PNG, WebP formats. Maintain quality while reducing file size up to 90%.">
    <meta name="keywords" content="image compression, image converter, reduce image size, compress photos, image optimization, HEIC converter, batch image compression, WebP conversion">
    <meta name="author" content="squishh">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <meta name="google" content="notranslate">
    <meta name="canonical" content="https://squishh.vercel.app">
    <meta name="google-site-verification" content="JV9yKhVQDHtaUsObfAvO3E5zCmRIEoG6rZohVEk7CPw" />
    <title>squishh - Advanced Image Compression & Conversion Tool</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" />

    <!-- Open Graph Tags -->
    <meta property="og:title" content="squishh - Advanced Image Compression & Conversion Tool">
    <meta property="og:description" content="Professional image compression and conversion tool. Support for HEIC, JPEG, PNG, WebP. Batch process multiple images while maintaining quality.">
    <meta property="og:image" content="https://squishh.vercel.app/images/og-image.png">
    <meta property="og:url" content="https://squishh.vercel.app">
    <meta property="og:type" content="website">

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="squishh - Advanced Image Compression & Conversion Tool">
    <meta name="twitter:description" content="Professional image compression and conversion tool. Support for HEIC, JPEG, PNG, WebP. Batch process multiple images while maintaining quality.">
    <meta name="twitter:image" content="https://squishh.vercel.app/images/og-image.png">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    [{
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "squishh",
        "description": "Professional image compression and conversion tool. Support for HEIC, JPEG, PNG, WebP formats. Batch process multiple images while maintaining quality.",
        "url": "https://squishh.vercel.app",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Batch image compression",
            "Multiple format conversion",
            "HEIC support",
            "Lossless compression",
            "WebP optimization",
            "Mobile-friendly"
        ],
        "screenshot": "https://squishh.vercel.app/images/og-image.png",
        "softwareVersion": "2.0"
    },
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [{
            "@type": "Question",
            "name": "What's the best image format for my website?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "For modern websites, WebP is recommended as it offers excellent compression and quality. For older browser support, use JPEG for photographs and PNG for images with text or transparency. Always provide JPEG/PNG fallbacks when using WebP."
            }
        }, {
            "@type": "Question",
            "name": "How do I optimize images for SEO?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "To optimize images for SEO: 1) Use descriptive file names 2) Add relevant alt text 3) Compress images to improve page speed 4) Use responsive images 5) Implement lazy loading 6) Create and submit an image sitemap."
            }
        }, {
            "@type": "Question",
            "name": "What's the recommended image size for websites?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Recommended file sizes: Hero images should be under 400KB, content images 150-200KB, thumbnails 20-30KB, and product images 100-200KB. For dimensions, ensure images are responsive and sized appropriately for their display context."
            }
        }, {
            "@type": "Question",
            "name": "What image formats does squishh support?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "squishh supports JPEG, PNG, WebP, and HEIC formats. You can convert between these formats while compressing your images."
            }
        }, {
            "@type": "Question",
            "name": "How does image compression work?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Image compression works by reducing file size while maintaining visual quality. We use smart algorithms to remove unnecessary data and optimize the image encoding, resulting in smaller file sizes without noticeable quality loss."
            }
        }, {
            "@type": "Question",
            "name": "Is there a file size limit?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "squishh can handle images up to 50MB in size. For best results, we recommend compressing images under 20MB at a time."
            }
        }, {
            "@type": "Question",
            "name": "Will compression affect image quality?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "The quality impact depends on your chosen compression level. At high quality settings (70-90%), the difference is usually imperceptible. Lower settings will reduce file size more but may affect image quality."
            }
        }, {
            "@type": "Question",
            "name": "Can I compress multiple images at once?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes! squishh supports batch processing. You can upload multiple images and compress them all at once, saving time and effort."
            }
        }]
    }]
    </script>

    <style>
        :root {
            --primary: #3B82F6;
            --primary-dark: #2563EB;
            --background: #F9FAFB;
            --text: #1F2937;
            --border: #E5E7EB;
            --success: #10B981;
            --error: #EF4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: #6B7280;
            font-size: 1.1rem;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .feature-card {
            background: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .upload-container {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .drop-zone {
            border: 2px dashed var(--border);
            border-radius: 0.75rem;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .drop-zone:hover {
            border-color: var(--primary);
            background: #F3F4F6;
        }

        .drop-zone.dragover {
            border-color: var(--primary);
            background: #EFF6FF;
        }

        .file-list {
            margin: 1rem 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            background: #F9FAFB;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .file-item .file-name {
            flex: 1;
            margin-right: 1rem;
        }

        .file-item .file-size {
            color: #6B7280;
            margin-right: 1rem;
        }

        .controls {
            display: none;
            margin-top: 2rem;
            background: #F9FAFB;
            padding: 1.5rem;
            border-radius: 0.75rem;
        }

        .controls.active {
            display: block;
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .quality-slider {
            width: 100%;
            margin: 1rem 0;
            -webkit-appearance: none;
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            outline: none;
        }

        .quality-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .quality-slider::-webkit-slider-thumb:hover {
            background: var(--primary-dark);
        }

        .format-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .format-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
            transform: none;
        }

        .progress-container {
            display: none;
            margin-top: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress {
            width: 0%;
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .results {
            margin-top: 2rem;
        }

        .result-item {
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .result-item img {
            max-width: 100%;
            height: auto;
            border-radius: 0.375rem;
            margin: 1rem 0;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .stat-item {
            background: var(--background);
            padding: 1rem;
            border-radius: 0.5rem;
        }

        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            color: #6B7280;
        }

        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .feature-card {
                padding: 1rem;
            }
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            background: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            overflow: hidden;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: relative;
            margin: auto;
            max-width: 90%;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .modal-image {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 0.5rem;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.5);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            transition: background-color 0.3s ease;
        }

        .modal-close:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-navigation {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 1rem;
            pointer-events: none;
        }

        .modal-nav-button {
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            pointer-events: auto;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-nav-button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-caption {
            color: white;
            text-align: center;
            padding: 1rem;
            position: absolute;
            bottom: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .preview-zoom-icon {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .preview-wrapper:hover .preview-zoom-icon {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Add modal HTML -->
        <div id="imageModal" class="modal">
            <div class="modal-content">
                <button class="modal-close" onclick="closeModal()">✕</button>
                <img class="modal-image" id="modalImage">
                <div class="modal-navigation">
                    <button class="modal-nav-button" onclick="changeImage(-1)">❮</button>
                    <button class="modal-nav-button" onclick="changeImage(1)">❯</button>
                </div>
                <div class="modal-caption" id="modalCaption"></div>
            </div>
        </div>
        
        <header>
            <h1>squishh</h1>
            <p class="subtitle">Advanced image compression & conversion</p>
        </header>

        <div class="features">
            <div class="feature-card">
                <h3>📦 Batch Processing</h3>
                <p>Compress multiple images at once. Save time and effort.</p>
            </div>
            <div class="feature-card">
                <h3>🔄 Format Conversion</h3>
                <p>Convert between JPEG, PNG, WebP, and HEIC formats.</p>
            </div>
            <div class="feature-card">
                <h3>📱 Mobile Friendly</h3>
                <p>Works perfectly on all devices, including iOS images.</p>
            </div>
        </div>

        <main class="upload-container">
            <div class="drop-zone" id="dropZone">
                <p>Drag & drop multiple images here or click to browse</p>
                <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
            </div>

            <div class="file-list" id="fileList"></div>

            <div id="previewContainer" style="display: none; margin: 1rem 0;">
                <h3 style="margin-bottom: 1rem;">Image Preview</h3>
                <div style="display: flex; overflow-x: auto; gap: 1rem; padding: 1rem 0;">
                    <!-- Preview images will be added here -->
                </div>
            </div>

            <div class="controls" id="controls">
                <div class="control-group">
                    <label for="quality">Compression Quality: <span id="qualityValue">80%</span></label>
                    <input type="range" id="quality" class="quality-slider" min="1" max="100" value="80">
                </div>

                <div class="control-group">
                    <label>Output Formats:</label>
                    <div class="format-options">
                        <label class="format-checkbox">
                            <input type="checkbox" value="jpeg" checked> JPEG
                        </label>
                        <label class="format-checkbox">
                            <input type="checkbox" value="png"> PNG
                        </label>
                        <label class="format-checkbox">
                            <input type="checkbox" value="webp" checked> WebP
                        </label>
                    </div>
                </div>

                <button class="btn" id="compressBtn">
                    Compress Images
                    <span id="fileCount"></span>
                </button>
            </div>

            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
                <p id="progressText" style="text-align: center; margin-top: 0.5rem;">Processing images...</p>
            </div>

            <div class="results" id="results"></div>
        </main>

        <footer>
            <p>&copy; 2024 squishh. All rights reserved. | Created by <a href="https://github.com/abdullah-w-21" style="color: var(--primary); text-decoration: none;" target="_blank" rel="noopener">abdullah-w-21</a></p>
            <div style="margin-top: 1rem;">
                <a href="https://github.com/abdullah-w-21/squish" target="_blank" rel="noopener" style="text-decoration: none;">
                    <button class="btn" style="background: #24292e;">
                        View on GitHub
                    </button>
                </a>
            </div>
            <div class="optimization-guide">
                <h2 style="text-align: center; margin: 3rem 0 2rem;">How to Use squishh</h2>
                <div class="features" style="text-align: left;">
                    <div class="feature-card">
                        <h3>1. Upload Your Images</h3>
                        <p>Drag and drop your images into the upload zone or click to browse. You can select multiple images at once.</p>
                    </div>
                    <div class="feature-card">
                        <h3>2. Choose Your Settings</h3>
                        <p>Adjust the compression quality slider and select your desired output formats. Higher quality means larger files.</p>
                    </div>
                    <div class="feature-card">
                        <h3>3. Process and Download</h3>
                        <p>Click "Compress Images" and wait for processing to complete. Download your optimized images in your chosen formats.</p>
                    </div>
                </div>

                <h2 style="text-align: center; margin: 3rem 0 2rem;">Image Optimization Guide</h2>
                <div class="features" style="text-align: left;">
                    <div class="feature-card">
                        <h3>Format Technical Details</h3>
                        <ul style="list-style: none; padding: 0;">
                            <li>• JPEG (Joint Photographic Experts Group)
                                <ul style="list-style: none; padding-left: 1rem; margin-top: 0.5rem; color: #666;">
                                    <li>- Lossy compression</li>
                                    <li>- 16.7 million colors</li>
                                    <li>- No transparency support</li>
                                    <li>- Best for: Photos, complex images</li>
                                </ul>
                            </li>
                            <li style="margin-top: 1rem;">• PNG (Portable Network Graphics)
                                <ul style="list-style: none; padding-left: 1rem; margin-top: 0.5rem; color: #666;">
                                    <li>- Lossless compression</li>
                                    <li>- Up to 16-bit transparency</li>
                                    <li>- Ideal for logos, text</li>
                                    <li>- Supports animation (APNG)</li>
                                </ul>
                            </li>
                            <li style="margin-top: 1rem;">• WebP
                                <ul style="list-style: none; padding-left: 1rem; margin-top: 0.5rem; color: #666;">
                                    <li>- Modern format by Google</li>
                                    <li>- 26% smaller than PNG</li>
                                    <li>- 25-35% smaller than JPEG</li>
                                    <li>- Supports animation & transparency</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h3>Optimization by Use Case</h3>
                        <div style="margin-bottom: 1rem;">
                            <h4 style="color: var(--primary-dark);">Web & E-commerce</h4>
                            <ul style="list-style: none; padding: 0; color: #666;">
                                <li>• Product images: JPEG 80-85% quality</li>
                                <li>• Thumbnails: WebP with 70-75% quality</li>
                                <li>• Logos: PNG or SVG for scalability</li>
                                <li>• Hero images: JPEG 85-90% or WebP</li>
                            </ul>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <h4 style="color: var(--primary-dark);">Social Media</h4>
                            <ul style="list-style: none; padding: 0; color: #666;">
                                <li>• Instagram: JPEG 85-90% quality</li>
                                <li>• Facebook: JPEG 80-85% quality</li>
                                <li>• Twitter: PNG for graphics, JPEG for photos</li>
                                <li>• LinkedIn: JPEG 80% for posts</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: var(--primary-dark);">Email & Marketing</h4>
                            <ul style="list-style: none; padding: 0; color: #666;">
                                <li>• Email images: JPEG 70-80% quality</li>
                                <li>• Newsletters: WebP with fallback JPEG</li>
                                <li>• Banners: PNG for text clarity</li>
                            </ul>
                        </div>
                    </div>

                    <div class="feature-card">
                        <h3>Advanced Optimization Tips</h3>
                        <div style="margin-bottom: 1rem;">
                            <h4 style="color: var(--primary-dark);">Quality Settings</h4>
                            <ul style="list-style: none; padding: 0; color: #666;">
                                <li>• 90-100%: Print, professional photography</li>
                                <li>• 80-90%: E-commerce, portfolio websites</li>
                                <li>• 70-80%: General web use, blogs</li>
                                <li>• 60-70%: Thumbnails, previews</li>
                                <li>• Below 60%: Only for tiny thumbnails</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: var(--primary-dark);">Size Guidelines</h4>
                            <ul style="list-style: none; padding: 0; color: #666;">
                                <li>• Hero images: Max 400KB</li>
                                <li>• Content images: 150-200KB</li>
                                <li>• Thumbnails: 20-30KB</li>
                                <li>• Product images: 100-200KB</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <h2 style="text-align: center; margin: 3rem 0 2rem;">Frequently Asked Questions</h2>
                <div style="max-width: 800px; margin: 0 auto;">
                    <div class="faq-item" style="background: white; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h3>What image formats does squishh support?</h3>
                        <p>squishh supports JPEG, PNG, WebP, and HEIC formats. You can convert between these formats while compressing your images.</p>
                    </div>
                    <div class="faq-item" style="background: white; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h3>How does image compression work?</h3>
                        <p>Image compression works by reducing file size while maintaining visual quality. We use smart algorithms to remove unnecessary data and optimize the image encoding, resulting in smaller file sizes without noticeable quality loss.</p>
                    </div>
                    <div class="faq-item" style="background: white; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h3>Is there a file size limit?</h3>
                        <p>squishh can handle images up to 50MB in size. For best results, we recommend compressing images under 20MB at a time.</p>
                    </div>
                    <div class="faq-item" style="background: white; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h3>Will compression affect image quality?</h3>
                        <p>The quality impact depends on your chosen compression level. At high quality settings (70-90%), the difference is usually imperceptible. Lower settings will reduce file size more but may affect image quality.</p>
                    </div>
                    <div class="faq-item" style="background: white; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h3>Can I compress multiple images at once?</h3>
                        <p>Yes! squishh supports batch processing. You can upload multiple images and compress them all at once, saving time and effort.</p>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Utility functions
        const formatFileSize = (bytes) => {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        };

        const showToast = (message, type = 'success') => {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.background = type === 'success' ? '#DEF7EC' : '#FDE8E8';
            toast.style.color = type === 'success' ? '#03543F' : '#9B1C1C';
            toast.innerHTML = `
                <span>${message}</span>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; cursor: pointer;">✕</button>
            `;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 5000);
        };

        // DOM Elements
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const controls = document.getElementById('controls');
        const qualitySlider = document.getElementById('quality');
        const qualityValue = document.getElementById('qualityValue');
        const compressBtn = document.getElementById('compressBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progress = document.getElementById('progress');
        const progressText = document.getElementById('progressText');
        const results = document.getElementById('results');
        const fileList = document.getElementById('fileList');
        const fileCount = document.getElementById('fileCount');

        let files = [];

        // Event Listeners
        dropZone.addEventListener('click', () => fileInput.click());

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        qualitySlider.addEventListener('input', () => {
            qualityValue.textContent = qualitySlider.value + '%';
        });

        compressBtn.addEventListener('click', processImages);

        // File handling
        function handleFiles(fileList) {
            const newFiles = Array.from(fileList).filter(file => {
                const type = file.type.toLowerCase();
                return type.startsWith('image/') || 
                       type === 'image/heic' || 
                       type === 'image/heif' ||
                       file.name.toLowerCase().endsWith('.heic');
            });

            if (newFiles.length === 0) {
                showToast('Please upload valid image files.', 'error');
                return;
            }

            files = [...files, ...newFiles];
            updateFileList();
            updatePreviews();
            controls.classList.add('active');
            fileCount.textContent = `(${files.length} ${files.length === 1 ? 'file' : 'files'})`;
        }

        function updatePreviews() {
            const previewContainer = document.getElementById('previewContainer');
            const previewsDiv = previewContainer.querySelector('div');
            previewsDiv.innerHTML = '';

            if (files.length > 0) {
                previewContainer.style.display = 'block';
                files.forEach((file, index) => {
                    const previewWrapper = document.createElement('div');
                    previewWrapper.className = 'preview-wrapper';
                    previewWrapper.style.position = 'relative';
                    previewWrapper.style.minWidth = '200px';
                    previewWrapper.style.marginBottom = '1rem';
                    previewWrapper.style.cursor = 'pointer';

                    const preview = document.createElement('img');
                    preview.style.width = '200px';
                    preview.style.height = '200px';
                    preview.style.objectFit = 'contain';
                    preview.style.borderRadius = '0.5rem';
                    preview.style.backgroundColor = '#f3f4f6';

                    // Add zoom icon
                    const zoomIcon = document.createElement('div');
                    zoomIcon.className = 'preview-zoom-icon';
                    zoomIcon.innerHTML = '🔍';
                    previewWrapper.appendChild(zoomIcon);

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        preview.src = e.target.result;
                    };
                    reader.readAsDataURL(file);

                    const caption = document.createElement('div');
                    caption.style.marginTop = '0.5rem';
                    caption.style.fontSize = '0.875rem';
                    caption.style.color = '#6B7280';
                    caption.textContent = file.name;

                    // Add click handler for preview
                    previewWrapper.onclick = () => openModal(index);

                    previewWrapper.appendChild(preview);
                    previewWrapper.appendChild(caption);
                    previewsDiv.appendChild(previewWrapper);
                });
            } else {
                previewContainer.style.display = 'none';
            }
        }

        // Modal functionality
        let currentImageIndex = 0;
        const modal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const modalCaption = document.getElementById('modalCaption');

        function openModal(index) {
            currentImageIndex = index;
            showModalImage();
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevent scrolling

            // Add keyboard navigation
            document.addEventListener('keydown', handleKeyPress);
        }

        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = ''; // Restore scrolling
            document.removeEventListener('keydown', handleKeyPress);
        }

        function showModalImage() {
            const file = files[currentImageIndex];
            const reader = new FileReader();
            reader.onload = (e) => {
                modalImage.src = e.target.result;
                modalCaption.textContent = `${file.name} (${formatFileSize(file.size)})`;
            };
            reader.readAsDataURL(file);
        }

        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + files.length) % files.length;
            showModalImage();
        }

        function handleKeyPress(e) {
            if (e.key === 'Escape') closeModal();
            if (e.key === 'ArrowLeft') changeImage(-1);
            if (e.key === 'ArrowRight') changeImage(1);
        }

        // Close modal when clicking outside the image
        modal.onclick = (e) => {
            if (e.target === modal) closeModal();
        };

        function updateFileList() {
            fileList.innerHTML = files.map((file, index) => `
                <div class="file-item">
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">${formatFileSize(file.size)}</span>
                    <button class="btn" style="padding: 0.25rem 0.5rem;" onclick="removeFile(${index})">✕</button>
                </div>
            `).join('');
        }

        function removeFile(index) {
            files.splice(index, 1);
            updateFileList();
            fileCount.textContent = `(${files.length} ${files.length === 1 ? 'file' : 'files'})`;
            if (files.length === 0) {
                controls.classList.remove('active');
            }
        }

        // Image processing
        async function processImages() {
            if (files.length === 0) return;

            const quality = parseInt(qualitySlider.value) / 100;
            const selectedFormats = Array.from(document.querySelectorAll('.format-checkbox input:checked'))
                .map(input => input.value);

            if (selectedFormats.length === 0) {
                showToast('Please select at least one output format.', 'error');
                return;
            }

            progressContainer.style.display = 'block';
            compressBtn.disabled = true;
            results.innerHTML = '';

            try {
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    progressText.textContent = `Processing ${i + 1} of ${files.length}: ${file.name}`;
                    progress.style.width = ((i + 1) / files.length * 100) + '%';

                    const processedImages = await processImage(file, quality, selectedFormats);
                    displayResults(file, processedImages);
                }

                showToast('All images processed successfully!');
            } catch (error) {
                console.error('Error processing images:', error);
                showToast('Error processing some images. Please try again.', 'error');
            } finally {
                progressContainer.style.display = 'none';
                compressBtn.disabled = false;
                progress.style.width = '0%';
            }
        }

        async function processImage(file, quality, formats) {
            const processedImages = [];

            // Create image bitmap
            const imageBitmap = await createImageBitmap(file);
            
            // Create canvas
            const canvas = document.createElement('canvas');
            canvas.width = imageBitmap.width;
            canvas.height = imageBitmap.height;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(imageBitmap, 0, 0);

            // Process for each selected format
            for (const format of formats) {
                try {
                    const blob = await new Promise((resolve) => {
                        // Adjust quality based on format
                        let adjustedQuality = quality;
                        if (format === 'png') {
                            // PNG doesn't use quality parameter
                            adjustedQuality = undefined;
                        } else if (format === 'webp' && quality > 0.8) {
                            // WebP works better with slightly lower quality
                            adjustedQuality = 0.8;
                        }

                        canvas.toBlob(
                            (blob) => resolve(blob),
                            `image/${format}`,
                            adjustedQuality
                        );
                    });

                    processedImages.push({
                        format,
                        blob,
                        url: URL.createObjectURL(blob),
                        size: blob.size
                    });
                } catch (error) {
                    console.error(`Error processing ${format}:`, error);
                }
            }

            return processedImages;
        }

        function displayResults(originalFile, processedImages) {
            const resultItem = document.createElement('div');
            resultItem.className = 'result-item';

            const stats = document.createElement('div');
            stats.className = 'stats';
            stats.innerHTML = `
                <div class="stat-item">
                    <p>Original File: ${originalFile.name}</p>
                    <p>Size: ${formatFileSize(originalFile.size)}</p>
                </div>
            `;

            const downloadButtons = document.createElement('div');
            downloadButtons.style.display = 'flex';
            downloadButtons.style.gap = '0.5rem';
            downloadButtons.style.flexWrap = 'wrap';

            processedImages.forEach(img => {
                const compressionRatio = ((1 - (img.size / originalFile.size)) * 100).toFixed(1);
                const savings = compressionRatio > 0 ? `${compressionRatio}% smaller` : 'No reduction';

                stats.innerHTML += `
                    <div class="stat-item">
                        <p>${img.format.toUpperCase()}</p>
                        <p>Size: ${formatFileSize(img.size)}</p>
                        <p>${savings}</p>
                    </div>
                `;

                const downloadBtn = document.createElement('button');
                downloadBtn.className = 'btn';
                downloadBtn.innerHTML = `Download ${img.format.toUpperCase()}`;
                downloadBtn.onclick = () => {
                    const link = document.createElement('a');
                    link.href = img.url;
                    link.download = `${originalFile.name.split('.')[0]}_compressed.${img.format}`;
                    link.click();
                };
                downloadButtons.appendChild(downloadBtn);
            });

            resultItem.appendChild(stats);
            resultItem.appendChild(downloadButtons);
            results.appendChild(resultItem);
        }
    </script>
</body>
</html>
